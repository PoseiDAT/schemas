{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://poseidat.org/schema/core/measurement/ais-measurement.json",
  "title": "AIS measurement value",
  "description": "The value of a certain type of AIS measurement",
  "properties": {
    "entity_id": {
      "description": "The mmsi identifier (ais entity )this value is related to",
      "type": "number"
    },
    "message_type" :{
      "description": "the message type of the given AIS measurement",
      "$ref": "https://poseidat.org/schema/enum/ais-message-type.json"
    },
    "nav_status": {
      "description": "The status of navigation",
      "$ref": "https://poseidat.org/schema/enum/ais-nav-status.json"
    },
    "position_device_type": {
      "description": "The type of navigation device",
      "$ref": "https://poseidat.org/schema/enum/ais-position-device-type.json"
    },
    "repeat_indicator": {
      "description": "The amount of times the message has been repeated (3 is do not repeat anymore)",
      "type": "number",
      "default": 3
    },
    "callsign": {
      "description": "The call sign of the given AIS entity, '@@@@@@@' is default",
      "type": "string",
      "default": "@@@@@@@"
    },
    "entity_name": {
      "description": "The name of the AIS entity",
      "type": "string",
      "maximum": 20,
      "default": "@@@@@@@@@@@@@@@@@@@@"
    },
    "entity_type": {
      "description": "The type of vessel given by the AIS, default is 0 ('Not available (default)')",
      "$ref": "https://poseidat.org/schema/enum/ais-ship-type.json",
      "default": 0
    },
    "dimension_ship": {
      "description": "Indicates the dimension of ship",
      "type": "number",
      "default": 0
    },
    "timestamp": {
      "description": "UTC timestamp in seconds of the ais message",
      "type": "number",
      "default": 0
    },
    "SOG": {
      "description": "The Speed over ground of the ship",
      "type": "number",
      "default": 0
    },
    "ROT": {
      "description": "The Rate Of Turn of the ship in degrees, minus = turning left; plus = turning right; (128  no turn information available (default))",
      "type": "number",
      "default": -128,
      "minimum": -128,
      "maximum": 127
    },
    "true_heading": {
      "description": "Degrees (0-359) (511 indicates not available = default)",
      "type": "number",
      "default": 511
    },
    "SOTDMA_communication_state": {
      "description": "Degrees (0-359) (511 indicates not available = default)",
      "type": "number",
      "default": 511
    },
    "RAIM_flag": {
      "description": "Receiver autonomous integrity monitoring (RAIM) flag of electronic position fixing device",
      "$ref": "https://poseidat.org/schema/enum/ais-special-maneuvre.json",
      "default": 0
    },
    "position": {
      "description": "A positional measurement",
      "$ref": "https://poseidat.org/schema/core/measurement/position.json"
    },
    "position_accuracy": {
      "description": "The accuracy of the given position",
      "$ref": "https://poseidat.org/schema/enum/ais-position-accuracy.json",
      "default": 0
    },
    "binary_data": {
      "description": "A numerical measurement",
      "$ref": "https://poseidat.org/schema/core/measurement/numeric.json",
      "default": 0
    },
    "binary_data_array": {
      "description": "A numerical measurement",
      "$ref": "https://poseidat.org/schema/core/measurement/numeric.json",
      "default": 0,
      "type": "array"
    },
    "ETA": {
      "description": "Estimated time of arrival",
      "type": "string",
      "format": "date-time"
    },
    "IMO_number": {
      "description": "The International Maritime Organization (IMO) number is a unique identifier for ships",
      "type": "number",
      "default": 0
    },
    "maximum_draught": {
      "description": "Maximum present static draught in meters",
      "type": "number",
      "default": 0
    },
    "destination": {
      "description": "Destination of the vessel, Maximum 20 characters",
      "type": "string",
      "maxLength": 20
    },
    "special_maneuvre_indicator": {
      "description": "Indicates whether an special maneuver is ongoing",
      "$ref": "https://poseidat.org/schema/enum/ais-special-maneuvre.json",
      "default": 0
    },
    "DTE": {
      "description": "Data terminal equipment (DTE) ready",
      "$ref": "https://poseidat.org/schema/enum/ais-DTE.json",
      "default": 1
    },
    "control_long_range_message": {
      "description": "Transmission control for long-range broadcast message",
      "$ref": "https://poseidat.org/schema/enum/ais-control-long-range.json",
      "default": 0
    }
 },
 "required": ["entity_id", "message_type"],
 "oneOf": [
  {
    "if": {
      "properties": {
        "message_type": {
          "oneOf": [
            { "const": 1},
            { "const": 2},
            { "const": 3}
          ]
        }
      }
    },
    "then": {
      "required": ["position", "RAIM_flag","COG","true_heading", "special_maneuvre_indicator",
        "position_accuracy","ROT", "SOG", "repeat_indicator", "timestamp"]
    }
  },
  {
    "if": {
      "properties": {
        "message_type": {
          "oneOf": [
            { "const": 4},
            { "const": 11}
          ]
        }
      }
    },
    "then": {
      "required": ["position", "position_accuracy", "position_device_type","timestamp", "repeat_indicator", "RAIM_flag", "SOTDMA_communication_state"]
    }
  },
  {
    "if": {
      "properties": {
        "message_type": { "const": 5}
      }
    },
    "then": {
      "required": ["repeat_indicator", "maximum_draught", "IMO_number", "callsign", "entity_type", "entity_name", "dimension_ship", "position_device_type", "ETA", "destination", "DTE"]
    }
  },
  {
    "if": {
      "properties": {
        "message_type": {
          "oneOf": [
            { "const": 6},
            { "const": 7},
            { "const": 8 },
            { "const": 25 },
            { "const": 26 }
          ]
        }
      }
    },
    "then": {
      "oneOf": [
        { "required": [ "repeat_indicator", "binary_data" ] },
        { "required": [ "repeat_indicator", "binary_data_array" ] }
      ]
    }
  },
  {
    "if": {
      "properties": {
        "message_type": { "const": 9}
      }
    },
    "then": {
      "required": ["repeat_indicator", "IMO_number", "callsign", "entity_type", "entity_name", "dimension_ship", "position_device_type", "ETA", "destination", "DTE"]
    }
  }
 ],
  "type": "object",
  "additionalProperties": false
}
